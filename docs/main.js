!function(e){function t(t){for(var n,r,i=t[0],a=t[1],l=0,s=[];l<i.length;l++)r=i[l],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&s.push(o[r][0]),o[r]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);for(c&&c(t);s.length;)s.shift()()}var n={},o={0:0};function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.e=function(e){var t=[],n=o[e];if(0!==n)if(n)t.push(n[2]);else{var i=new Promise((function(t,r){n=o[e]=[t,r]}));t.push(n[2]=i);var a,l=document.createElement("script");l.charset="utf-8",l.timeout=120,r.nc&&l.setAttribute("nonce",r.nc),l.src=function(e){return r.p+""+e+".main.js"}(e);var c=new Error;a=function(t){l.onerror=l.onload=null,clearTimeout(s);var n=o[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+r+": "+i+")",c.name="ChunkLoadError",c.type=r,c.request=i,n[1](c)}o[e]=void 0}};var s=setTimeout((function(){a({type:"timeout",target:l})}),12e4);l.onerror=l.onload=a,document.head.appendChild(l)}return Promise.all(t)},r.m=e,r.c=n,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r.oe=function(e){throw console.error(e),e};var i=window.webpackJsonp=window.webpackJsonp||[],a=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var c=a;r(r.s=4)}([function(e,t,n){var o,r=r||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,n=function(){return e.URL||e.webkitURL||e},o=t.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in o,i=/constructor/i.test(e.HTMLElement)||e.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent),l=function(t){(e.setImmediate||e.setTimeout)((function(){throw t}),0)},c=function(e){setTimeout((function(){"string"==typeof e?n().revokeObjectURL(e):e.remove()}),4e4)},s=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},d=function(t,d,p){p||(t=s(t));var u,f=this,g="application/octet-stream"===t.type,m=function(){!function(e,t,n){for(var o=(t=[].concat(t)).length;o--;){var r=e["on"+t[o]];if("function"==typeof r)try{r.call(e,n||e)}catch(e){l(e)}}}(f,"writestart progress write writeend".split(" "))};if(f.readyState=f.INIT,r)return u=n().createObjectURL(t),void setTimeout((function(){var e,t;o.href=u,o.download=d,e=o,t=new MouseEvent("click"),e.dispatchEvent(t),m(),c(u),f.readyState=f.DONE}));!function(){if((a||g&&i)&&e.FileReader){var o=new FileReader;return o.onloadend=function(){var t=a?o.result:o.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,f.readyState=f.DONE,m()},o.readAsDataURL(t),void(f.readyState=f.INIT)}(u||(u=n().createObjectURL(t)),g)?e.location.href=u:e.open(u,"_blank")||(e.location.href=u);f.readyState=f.DONE,m(),c(u)}()},p=d.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=s(e)),navigator.msSaveOrOpenBlob(e,t)}:(p.abort=function(){},p.readyState=p.INIT=0,p.WRITING=1,p.DONE=2,p.error=p.onwritestart=p.onprogress=p.onwrite=p.onabort=p.onerror=p.onwriteend=null,function(e,t,n){return new d(e,t||e.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */e.exports?e.exports.saveAs=r:null!==n(2)&&null!==n(3)&&(void 0===(o=function(){return r}.call(t,n,t,e))||(e.exports=o))},function(e,t){
/*! @source http://purl.eligrey.com/github/canvas-toBlob.js/blob/master/canvas-toBlob.js */
!function(e){"use strict";var t,n=e.Uint8Array,o=e.HTMLCanvasElement,r=o&&o.prototype,i=/\s*;\s*base64\s*(?:;|$)/i,a="toDataURL",l=function(e){for(var o,r,i=e.length,a=new n(i/4*3|0),l=0,c=0,s=[0,0],d=0,p=0;i--;)r=e.charCodeAt(l++),255!==(o=t[r-43])&&void 0!==o&&(s[1]=s[0],s[0]=r,p=p<<6|o,4===++d&&(a[c++]=p>>>16,61!==s[1]&&(a[c++]=p>>>8),61!==s[0]&&(a[c++]=p),d=0));return a};n&&(t=new n([62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,0,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51])),!o||r.toBlob&&r.toBlobHD||(r.toBlob||(r.toBlob=function(e,t){if(t||(t="image/png"),this.mozGetAsFile)e(this.mozGetAsFile("canvas",t));else if(this.msToBlob&&/^\s*image\/png\s*(?:$|;)/i.test(t))e(this.msToBlob());else{var o,r=Array.prototype.slice.call(arguments,1),c=this[a].apply(this,r),s=c.indexOf(","),d=c.substring(s+1),p=i.test(c.substring(0,s));Blob.fake?((o=new Blob).encoding=p?"base64":"URI",o.data=d,o.size=d.length):n&&(o=p?new Blob([l(d)],{type:t}):new Blob([decodeURIComponent(d)],{type:t})),e(o)}}),!r.toBlobHD&&r.toDataURLHD?r.toBlobHD=function(){a="toDataURLHD";var e=this.toBlob();return a="toDataURL",e}:r.toBlobHD=r.toBlob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this)},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,n){"use strict";n.r(t);const o={id:"app-vertice",type:"symbol",source:"app-vertice",filter:["all",["has","cumulative_length"]],paint:{"text-color":"#000","text-halo-color":"#FFF","text-halo-width":2},layout:{"text-field":"aaa","text-field":["concat",["to-string",["/",["round",["*",100,["get","cumulative_length"]]],100]]," km"],"text-size":16,"text-font":["Noto Sans Regular"],"text-offset":[0,1],"text-allow-overlap":!1}},r={id:"app-end-circle",type:"circle",source:"app-vertice",filter:["all",["==","isEnd",!0]],paint:{"circle-radius":8,"circle-color":"#e74230"}},i=new URLSearchParams(window.location.search),a=document.getElementById("url"),l=e=>{i.set("g",e.geometry.coordinates.map(e=>e.join(",")).join(";")),window.history.replaceState({},"",`?${i.toString()}${window.location.hash}`),a.value=window.location.href};const c=async e=>{const t=await n.e(1).then(n.t.bind(null,5,7)),{coordinates:o}=e,r={type:"FeatureCollection",features:[{type:"Feature",properties:{cumulative_length:0,isEnd:!0},geometry:{type:"Point",coordinates:o[0]}}]};let i=0;for(let e=1;e<o.length;e++){const n=t.point(o[e-1]),a=t.point(o[e]);i+=t.distance(n,a),r.features.push({type:"Feature",properties:{cumulative_length:i,isEnd:e===o.length-1},geometry:{type:"Point",coordinates:o[e]}})}return{vertice:r}},s=document.getElementById("wizard-trail"),d=document.getElementById("wizard-download"),p=document.getElementById("wizard-copy"),u=document.getElementById("wizard-copied"),f=(e,t,n=0)=>{const o=t?"block":"none";let r=null;switch(e){case"trail":r=s;break;case"download":r=d;break;case"copy":r=p;break;case"copied":r=u}r&&setTimeout(()=>r.style.display=o,n)};n(1);var g=n(0),m=n.n(g);const h={loading:'\n  <svg style="width: 100%; height: 100%;" width="45" height="45" viewBox="0 0 45 45" stroke="#fff">\n    <g fill="none" fill-rule="evenodd" transform="translate(1 1)" stroke-width="2">\n      <circle cx="22" cy="22" r="6" stroke-opacity="0">\n        <animate attributeName="r"\n              begin="1.5s" dur="3s"\n              values="6;22"\n              calcMode="linear"\n              repeatCount="indefinite" />\n        <animate attributeName="stroke-opacity"\n              begin="1.5s" dur="3s"\n              values="1;0" calcMode="linear"\n              repeatCount="indefinite" />\n        <animate attributeName="stroke-width"\n              begin="1.5s" dur="3s"\n              values="2;0" calcMode="linear"\n              repeatCount="indefinite" />\n      </circle>\n      <circle cx="22" cy="22" r="6" stroke-opacity="0">\n        <animate attributeName="r"\n              begin="3s" dur="3s"\n              values="6;22"\n              calcMode="linear"\n              repeatCount="indefinite" />\n        <animate attributeName="stroke-opacity"\n              begin="3s" dur="3s"\n              values="1;0" calcMode="linear"\n              repeatCount="indefinite" />\n        <animate attributeName="stroke-width"\n              begin="3s" dur="3s"\n              values="2;0" calcMode="linear"\n              repeatCount="indefinite" />\n      </circle>\n      <circle cx="22" cy="22" r="8">\n        <animate attributeName="r"\n              begin="0s" dur="1.5s"\n              values="6;1;2;3;4;5;6"\n              calcMode="linear"\n              repeatCount="indefinite" />\n      </circle>\n    </g>\n  </svg>\n  ',download:'\n  <svg height="19px" viewBox="0 0 14 19" width="14px" xmlns="http://www.w3.org/2000/svg">\n    <title/><desc/><defs/>\n    <g fill="none" fill-rule="evenodd" id="Page-1" stroke="none" stroke-width="1">\n      <g fill="#000000" id="Core" transform="translate(-383.000000, -213.000000)">\n        <g id="file-download" transform="translate(383.000000, 213.500000)">\n          <path d="M14,6 L10,6 L10,0 L4,0 L4,6 L0,6 L7,13 L14,6 L14,6 Z M0,15 L0,17 L14,17 L14,15 L0,15 L0,15 Z" id="Shape"/>\n        </g>\n      </g>\n    </g>\n  </svg>\n  '};var y=h;var w=class{constructor(e={}){this.options=Object.assign({dpi:300,attribution:"© OpenStreetMap Contributors",textFont:[]},e)}onAdd(e){this.container=document.createElement("div"),this.container.className="mapboxgl-ctrl mapboxgl-ctrl-group";const t=document.createElement("button");return t.className="mapboxgl-ctrl-icon mapbox-gl-download",t.type="button",t.setAttribute("aria-label","Download"),t.innerHTML=y.download,this.container.appendChild(t),t.addEventListener("click",()=>{const t=window.devicePixelRatio;Object.defineProperty(window,"devicePixelRatio",{get:()=>this.options.dpi/96});const n=this.loading(),o=document.createElement("div");document.body.appendChild(o);const r=e.getContainer().offsetWidth,i=e.getContainer().offsetHeight,a=e.unproject([r,i]).toArray();this.setStyles(o,{visibility:"hidden",position:"absolute",top:0,bottom:0,width:r+"px",height:i+"px"});let l,c=[];e.style.glyphManager&&e.style.glyphManager.localIdeographFontFamily&&(c=e.style.glyphManager.localIdeographFontFamily),l=void 0!==window.geolonia?window.geolonia.Map:mapboxgl.Map;const s=new l({container:o,center:e.getCenter(),zoom:e.getZoom(),bearing:e.getBearing(),pitch:e.getPitch(),style:e.getStyle(),localIdeographFontFamily:c,hash:!1,preserveDrawingBuffer:!0,interactive:!1,attributionControl:!1});s.once("load",()=>{const r={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:a},properties:{text:this.options.attribution}}]};s.addSource("attribution-for-image",{type:"geojson",data:r});let i=[];if(this.options.textFont.length)i=this.options.textFont;else{const t=e.getStyle().layers;for(let n=0;n<t.length;n++)try{const o=e.getLayoutProperty(t[n].id,"text-font");if(o&&o.length){i=o;break}}catch(e){}}s.addLayer({id:"markers",type:"symbol",source:"attribution-for-image",paint:{"text-color":"#000000","text-halo-color":"rgba(255, 255, 255, 1)","text-halo-width":2},layout:{"text-field":"{text}","text-font":i,"text-size":18,"text-anchor":"bottom-right","text-max-width":28,"text-offset":[-.5,-.5],"text-allow-overlap":!0}}),setTimeout(()=>{s.getCanvas().toBlob(e=>{m.a.saveAs(e,s.getCenter().toArray().join("-")+".png"),s.remove(),o.parentNode.removeChild(o),n.parentNode.removeChild(n),Object.defineProperty(window,"devicePixelRatio",{get:()=>t})})},3e3)})}),this.container}onRemove(){this.container.parentNode.removeChild(this.container)}loading(){const e=document.createElement("div");document.body.appendChild(e),this.setStyles(e,{position:"absolute",top:0,bottom:0,width:"100%",backgroundColor:"rgba(0, 0, 0, 0.6)",zIndex:9999});const t=document.createElement("div");return t.innerHTML=y.loading,this.setStyles(t,{position:"absolute",top:0,bottom:0,left:0,right:0,zIndex:9999,margin:"auto",width:"120px",height:"120px"}),e.appendChild(t),e}setStyles(e,t){for(const n in t)e.style[n]=t[n]}};const v=new geolonia.Map("#map"),b=new MapboxDraw({controls:{point:!1,polygon:!1,combine_features:!1,uncombine_features:!1},styles:[{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#e74230","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#e74230","line-dasharray":[.2,2],"line-width":2}}]}),x=new w({dpi:300,attribution:"© Geolonia © OpenStreetMap Contributors"}),C=new class{constructor(e){this.options=e}onAdd(){this.container=document.createElement("div"),this.container.className="mapboxgl-ctrl mapboxgl-ctrl-group";const e=document.createElement("button");return e.className="mapboxgl-ctrl-icon mapbox-gl-copy-to-clipboard",e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center",e.type="button",e.setAttribute("aria-label","copy url to clipboard"),e.innerHTML='<?xml version="1.0" encoding="UTF-8"?>\n<svg width="20px" height="20px" viewBox="0 0 84 84" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="Group-2" transform="translate(-9.000000, -8.000000)" fill="#000000" fill-rule="nonzero">\n            <g id="Group" transform="translate(51.073130, 50.399487) scale(-1, 1) rotate(45.000000) translate(-51.073130, -50.399487) translate(0.073130, 30.399487)">\n                <path d="M41.1538462,0 C51.9871239,0 60.7692308,8.80468294 60.7692308,19.6658098 C60.7692308,30.4183253 52.1618879,39.1553202 41.4782224,39.3289849 L41.1538462,39.3316195 L19.6153846,39.3316195 C8.78210683,39.3316195 0,30.5269366 0,19.6658098 C0,17.5361771 1.72198173,15.8097686 3.84615385,15.8097686 C5.94343771,15.8097686 7.64864877,17.4927471 7.69148263,19.5851342 L7.69230769,19.6658098 C7.69230769,26.2016526 12.924222,31.512375 19.4182147,31.6179358 L19.6153846,31.6195373 L41.1538462,31.6195373 C47.7387797,31.6195373 53.0769231,26.2676712 53.0769231,19.6658098 C53.0769231,13.129967 47.8450088,7.81924458 41.351016,7.71368372 L41.1538462,7.71208226 L19.6153846,7.71208226 C17.4912125,7.71208226 15.7692308,5.98567384 15.7692308,3.85604113 C15.7692308,1.7533658 17.4478939,0.0437711512 19.5349159,0.000827187325 L19.6153846,0 L41.1538462,0 Z" id="Rectangle" transform="translate(30.384615, 19.665810) scale(-1, -1) translate(-30.384615, -19.665810) "></path>\n                <path d="M81.9230769,0 C92.7563547,0 101.538462,8.80468294 101.538462,19.6658098 C101.538462,30.4183253 92.9311186,39.1553202 82.2474532,39.3289849 L81.9230769,39.3316195 L60.3846154,39.3316195 C49.5513376,39.3316195 40.7692308,30.5269366 40.7692308,19.6658098 C40.7692308,17.5361771 42.4912125,15.8097686 44.6153846,15.8097686 C46.7126685,15.8097686 48.4178795,17.4927471 48.4607134,19.5851342 L48.4615385,19.6658098 C48.4615385,26.2016526 53.6934528,31.512375 60.1874455,31.6179358 L60.3846154,31.6195373 L81.9230769,31.6195373 C88.5080105,31.6195373 93.8461538,26.2676712 93.8461538,19.6658098 C93.8461538,13.129967 88.6142395,7.81924458 82.1202468,7.71368372 L81.9230769,7.71208226 L60.3846154,7.71208226 C58.2604433,7.71208226 56.5384615,5.98567384 56.5384615,3.85604113 C56.5384615,1.7533658 58.2171247,0.0437711512 60.3041466,0.000827187325 L60.3846154,0 L81.9230769,0 Z" id="Rectangle"></path>\n            </g>\n        </g>\n    </g>\n</svg>',this.container.appendChild(e),e.addEventListener("click",()=>{a.select(),a.setSelectionRange(0,99999),document.execCommand("copy"),a.setSelectionRange(0,0),"function"==typeof this.options.callback&&this.options.callback()}),this.container}onRemove(){this.container.parentNode.removeChild(this.container)}}({callback:()=>{f("copy",!1,0),f("copied",!0,0),f("copied",!1,3e3)}});v.addControl(b,"top-right"),v.addControl(x),v.addControl(C),v.on("load",async()=>{const e=(()=>{let e;a.value=window.location.href;const t=i.get("g");if(t){try{e=t.split(";").map(e=>e.split(",").map(e=>parseFloat(e)))}catch(e){console.error(e)}if(e){const t={type:"LineString",coordinates:e};try{return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]}}catch(e){return console.error(e),null}}}})();document.querySelector("button.mapbox-gl-download").addEventListener("click",()=>{f("download",!1)});const t=e=>{if(e){v.getSource("app-vertice")&&(v.removeLayer(o.id),v.removeLayer("app-end-circle"),v.removeSource("app-vertice")),v.addSource("app-vertice",{type:"geojson",data:e}),v.addLayer(o),v.addLayer(r)}else v.removeLayer(o.id),v.removeLayer("app-end-circle"),v.removeSource("app-vertice")};if(e){b.set(e);const n=e.features[0],{vertice:o}=await c(n.geometry);t(o)}f("trail",!0,1e3),v.on("draw.create",async e=>{const n=e.features[0];b.deleteAll(),b.set({type:"FeatureCollection",features:[n]}),f("trail",!1),f("copied",!1),f("download",!0,1e3),f("copy",!0,1e3),f("download",!1,8e3),f("copy",!1,8e3);const{vertice:o}=await c(n.geometry);l(n),t(o)}),v.on("draw.update",async e=>{if("move"===e.action||"change_coordinates"===e.action){f("trail",!1);const e=b.getAll().features[0],{vertice:n}=await c(e.geometry);l(e),t(n)}}),v.on("draw.delete",()=>{t(!1),f("copied",!1),f("copy",!1),f("download",!1),f("trail",!0,1e3)})})}]);